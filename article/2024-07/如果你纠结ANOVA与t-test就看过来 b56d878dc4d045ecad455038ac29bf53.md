# 如果你纠结ANOVA与t-test就看过来

Title: 如果你纠结ANOVA与t-test就看过来
Date: 2024-7-1
Keywords: Statistic, ANOVA, t-test

---

本文列举一些非常基础的统计检验问题，如果你纠结ANOVA与t-test应该怎么用就请看过来。

---

[toc]

## 单因素 ANOVA 在什么情况下等价于 t-test

单因素方差分析（`ANOVA`）在某些情况下等价于t检验（`t-test`），具体来说，当单因素ANOVA用于比较两个组的均值时，它等价于独立样本t检验。以下是这两种方法等价的原因：

1. **比较的组数**：单因素ANOVA通常用于比较三个或更多组的均值，而t检验通常用于比较两个组的均值。当单因素ANOVA仅用于两个组时，它的结果与t检验的结果是一致的。
2. **假设**：两者都假设各组的样本来自正态分布的总体，且各组的方差相等（方差齐性）。
3. **检验统计量**：当只有两个组时，单因素ANOVA的F统计量实际上是t统计量的平方。具体来说，对于两个组的单因素ANOVA，$F = t^2$。
4. **p值**：两种方法在比较两个组时会产生相同的p值，因而对于假设检验会得出相同的结论。

### 数学上的等价性

假设我们有两个组，组`A`和组`B`，它们的均值分别为$\bar{X}_1$和$\bar{X}_2$，样本量分别为$n_1$和$n_2$，以及组内的样本方差为$s^2$。

对于t检验，t统计量的计算公式为：

$$
t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{s^2 \left( \frac{1}{n_1} + \frac{1}{n_2} \right)}}
$$

对于单因素ANOVA，F统计量的计算公式为：

$$
F = \frac{\text{组间方差}}{\text{组内方差}}
$$

当只有两个组时：

$$
F = t^2 
$$

### 小结

因此，当单因素ANOVA用于比较两个组时，它与独立样本t检验是等价的。无论是使用t检验还是单因素ANOVA，结果都是相同的。

## 单因素ANOVA与T检验等价时，是否需要做重复测量校验？

当单因素ANOVA与t检验等价时，通常不需要进行重复测量校验，因为这两者在比较两个独立样本组时所进行的假设检验并不涉及重复测量。

### 重复测量校验的场景

重复测量设计（也称为配对设计或相关样本设计）涉及在相同的受试者或相关的受试者组上进行多次测量。在这种情况下：

- 对于t检验，需要使用配对样本t检验（paired t-test）。
- 对于ANOVA，需要使用重复测量ANOVA（repeated measures ANOVA）。

### 等价情况的具体场景

单因素ANOVA与t检验等价的情况特指以下场景：

- 比较两个独立样本组的均值。
- 这时使用独立样本t检验（independent samples t-test）和单因素ANOVA（one-way ANOVA with two levels）。

在这种情况下，不涉及重复测量，因此不需要进行重复测量校验。

### 小结

单因素ANOVA与t检验等价时，通常不需要做重复测量校验，因为这两者在比较两个独立样本组时不会涉及重复测量设计。只有在重复测量设计中才需要考虑重复测量校验。

## 配对样本T检验是否与之相同

配对样本t检验（paired t-test）和独立样本t检验（independent samples t-test）及单因素ANOVA（one-way ANOVA with two levels）在某些方面有相似之处，但它们的适用场景和假设有所不同，因此不完全相同。

### 配对样本t检验的适用场景

配对样本t检验用于以下情况：

- 比较同一组受试者在两个不同时间点或两种不同条件下的测量值。
- 比较配对的受试者组（例如，配对的双胞胎）。

配对样本t检验的主要特点是数据是成对的，即每个受试者有两次测量，这些测量之间是相关的。

### 独立样本t检验和单因素ANOVA的适用场景

独立样本t检验和单因素ANOVA（用于比较两个组时）用于以下情况：

- 比较两个独立样本组的均值。
- 各组的样本是独立的，即组与组之间没有相关性。

### 数学关系

虽然配对样本t检验和独立样本t检验在计算t值时使用的公式有所不同，但在比较两个独立样本组时，独立样本t检验与单因素ANOVA是等价的（如前所述，F = t²）。

### 重复测量ANOVA

如果有多个配对测量（例如，三个或更多时间点或条件），则使用重复测量ANOVA（repeated measures ANOVA），而不是简单的配对样本t检验。

### 小结

- **独立样本t检验与单因素ANOVA（两组）**：用于比较两个独立样本组，是等价的。
- **配对样本t检验**：用于比较同一组受试者在两个不同时间点或条件下的测量值，不与独立样本t检验或单因素ANOVA等价。

配对样本t检验和独立样本t检验及单因素ANOVA用于不同类型的数据，因此不能互相替代。

## 配对样本T检验与独立样本T检验有何不同

配对样本t检验（paired t-test）和独立样本t检验（independent samples t-test）在假设、应用场景和计算方法上都有所不同。以下是两者的主要区别：

### 应用场景

**配对样本t检验**：

- 适用于同一个样本在不同时间点或条件下的两次测量。
- 适用于配对的样本（例如，双胞胎、左右手、治疗前后等）。
- 数据是成对的，每对数据之间存在关联。

**独立样本t检验**：

- 适用于比较两个独立样本组的均值。
- 样本组之间没有关联，每组数据是独立的。

### 假设

**配对样本t检验**：

- 数据成对，且每对之间的差值服从正态分布。
- 配对数据之间存在相关性。

**独立样本t检验**：

- 两组数据来自正态分布的总体。
- 两组数据的方差相等（方差齐性假设）。
- 各组样本是独立的。

### 计算方法

**配对样本t检验**：

1. 计算每对数据的差值。
2. 计算差值的平均值和标准差。
3. 计算t统计量：
    
    $$
    t = \frac{\bar{d}}{s_d / \sqrt{n}} 
    $$
    

其中，$\bar{d}$是差值的平均值，$s_d$是差值的标准差，$n$是配对样本的数量。

**独立样本t检验**：

1. 计算两组样本的均值和标准差。
2. 计算t统计量：
    
    $$
    t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{s_p^2 \left( \frac{1}{n_1} + \frac{1}{n_2} \right)}}
    $$
    

### 例子

**配对样本t检验**：

- 测量同一组学生在参加某个培训课程前后的成绩。
- 比较同一个病人在接受治疗前后的健康指标。

**独立样本t检验**：

- 比较两个不同班级的学生在同一次考试中的成绩。
- 比较两种不同治疗方法对两组病人的效果。

### 小结

- **配对样本t检验**用于成对的相关样本，比较同一组样本在不同条件下的表现。
- **独立样本t检验**用于独立的样本组，比较两个不同组的均值。

## 配对样本T检验需要进行多重比较校正，而独立样本T检验不需要，是这样吗

配对样本t检验和独立样本t检验本身都不涉及多重比较校正。多重比较校正是针对多次进行假设检验时出现的多个比较问题，而与具体使用的是配对样本t检验还是独立样本t检验无关。

### 多重比较校正

**多重比较问题**：

- 当进行多个统计检验时，犯第一类错误（即错误地拒绝原假设）的风险会增加。
- 如果进行多次t检验，不管是配对样本t检验还是独立样本t检验，都需要进行多重比较校正以控制整体的显著性水平（例如控制`FDR`：假阳性率）。

**常见的多重比较校正方法**：

- `Bonferroni`校正：将显著性水平$\alpha$除以比较的次数k，例如，如果进行了5次比较，显著性水平$\alpha$设置为$0.05$，则校正后的显著性水平为$0.05/5 = 0.01$。
- `Holm`校正、`Benjamini-Hochberg`校正等：这些方法提供更灵活和保守的多重比较校正。

### 配对样本t检验 vs. 独立样本t检验

- **配对样本t检验**：用于成对的数据，每对数据之间有相关性。如果只进行一次配对样本t检验，不需要多重比较校正。
- **独立样本t检验**：用于两个独立样本组的数据。如果只进行一次独立样本t检验，不需要多重比较校正。

### 何时需要多重比较校正

无论是配对样本t检验还是独立样本t检验，只有在以下情况下需要多重比较校正：

- 进行多个t检验。例如，比较多个变量或多个组时。
- 进行多次假设检验，例如在进行探索性分析时。

### 小结

- 配对样本t检验和独立样本t检验本身都不涉及多重比较校正。
- 只有在进行多次比较时，无论使用哪种t检验，都需要进行多重比较校正以控制总体显著性水平。
