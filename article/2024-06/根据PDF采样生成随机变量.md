# 根据PDF采样生成随机变量

Title: 根据PDF采样生成随机变量

Date: 2024-6-26

Keywords: Math, Statistics

---

前文利用平均分布生成服从特定PDF的随机变量，本文将它推进一步，能够解决PDF函数表达式未知的情况下，如何根据PDF采样生成随机变量的问题。

---

[toc]

接受-拒绝采样法（acceptance-rejection sampling）的数学原理基于概率和积分的概念。具体来说，接受-拒绝采样法利用了包络函数 $g(x)$ 和比例常数 $M$ 之间的关系来生成目标分布 $f(x)$ 的样本。

## 数学原理

假设我们有一个目标概率密度函数 $f(x)$，以及一个包络概率密度函数 $g(x)$，满足以下条件：

1. $f(x) \leq M g(x)$ 对所有 $x$ 成立，其中 $M$ 是一个常数。
2. $g(x)$ 是一个容易从中生成样本的概率密度函数。

接受-拒绝采样法的具体步骤如下：

1. **生成候选样本**：从包络分布 $g(x)$ 中生成一个候选样本 $x$。
2. **生成辅助随机数**：生成一个均匀分布的随机数 $u \sim \text{Uniform}(0, 1)$。
3. **接受或拒绝**：如果 $u \leq \frac{f(x)}{M g(x)}$，则接受 $x$ 作为目标分布 $f(x)$ 的样本；否则拒绝 $x$ 并返回步骤1。

生成效果如下，其中橙色线代表由随机数生成的PDF，它的表达式 $f(x)$ 是未知的，利用以上方法可以方便地构造 $g(x)$，使蓝色线是生成的数据直方图。二者相比，可见其生成效果较为理想。

![fit1](./根据PDF采样生成随机变量/fit1.png "fit1")

![fit2](./根据PDF采样生成随机变量/fit2.png "fig2")

## 理论证明

设定 $X$ 为从 $g(x)$ 中生成的候选样本，$U$ 为从 $\text{Uniform}(0, 1)$ 中生成的随机数。我们希望证明被接受的 $X$ 服从目标分布 $f(x)$。

首先，我们计算接受 $x$ 的概率：
$$ P(\text{接受} \mid X = x) = P\left(U \leq \frac{f(x)}{M g(x)} \mid X = x\right) = \frac{f(x)}{M g(x)} $$

由于 $X$ 是从包络分布 $g(x)$ 中生成的，所以 $X$ 的概率密度函数是 $g(x)$。

被接受的 $X$ 的联合概率密度函数为：
$$ h(x) = P(\text{接受} \cap X = x) = P(\text{接受} \mid X = x) \cdot g(x) = \frac{f(x)}{M g(x)} \cdot g(x) = \frac{f(x)}{M} $$

因此，被接受的样本的概率密度函数为：
$$ f_{\text{accepted}}(x) = \frac{h(x)}{\int_0^1 h(t) \, dt} = \frac{\frac{f(x)}{M}}{\int_0^1 \frac{f(t)}{M} \, dt} = \frac{f(x)}{\int_0^1 f(t) \, dt} $$

因为 $f(x)$ 是概率密度函数，所以它的积分为1：
$$ \int_0^1 f(t) \, dt = 1 $$

因此，$f_{\text{accepted}}(x)$ 为：
$$ f_{\text{accepted}}(x) = f(x) $$

这表明，被接受的样本的分布确实是目标分布 $f(x)$。
