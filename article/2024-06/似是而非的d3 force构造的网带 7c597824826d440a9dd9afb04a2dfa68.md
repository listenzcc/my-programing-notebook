# 似是而非的d3.force构造的网带

Title: 似是而非的d3.force构造的网带
Date: 2024-6-13
Keywords: Force, Equation, Simulation

---

本文描述了一个使用d3.force构造的网带模型，其中节点受重力和拉力作用并相互排斥，但模型存在不稳定性，无法准确反映实际物理过程。为解决该问题，建议引入更精确的物理方程和参数设置，如胡克定律和牛顿运动定律，以提高模型的稳定性和精确性。

[Linked nodes with elastic](https://observablehq.com/@listenzcc/linked-nodes-with-elastic)

---

[toc]

## 一个似是而非的网带模型

我使用d3.force构造了一个条状网带，它包含大量的节点，这些节点（node）与周围的节点通过边（link）连接。为了让它像是一条带子，我假设它的两端分别固定在同一水平面的两个点上，其余节点受到重力和周围节点的拉力，另外，为了让这些节点不至于”纠缠“在一起，我还设定了它们彼此排斥。

```jsx
const simulation = d3
    .forceSimulation(nodes)
    .force("charge", d3.forceManyBody().strength(-30))
    .force(
      "link",
      d3
        .forceLink(links)
        .strength((d) => (d.source.strength ? d.source.strength : 2))
        .distance((d) => (d.distance ? d.distance : 10))
        .iterations(10)
    )
    .force("y", d3.forceY(height).strength(0.01))
```

![Untitled](%E4%BC%BC%E6%98%AF%E8%80%8C%E9%9D%9E%E7%9A%84d3%20force%E6%9E%84%E9%80%A0%E7%9A%84%E7%BD%91%E5%B8%A6%207c597824826d440a9dd9afb04a2dfa68/Untitled.png)

![Untitled](%E4%BC%BC%E6%98%AF%E8%80%8C%E9%9D%9E%E7%9A%84d3%20force%E6%9E%84%E9%80%A0%E7%9A%84%E7%BD%91%E5%B8%A6%207c597824826d440a9dd9afb04a2dfa68/Untitled.gif)

## 它的问题出在哪里？

这个模型看上去不错，似乎可以用来描述一条有弹力的带子受到重力和局部拉力而产生形变的过程。但它有一个关键的缺陷，那就是不够稳定。这体现在力学参数变化时，很有可能导致模型无法稳定收敛。

这个不稳定性源于模型中各力之间的平衡并不精确。节点之间的排斥力和连接它们的拉力并不能完美地模拟真实物理世界中的弹性和应力分布，特别是在节点数量较多或者外部力较大时，模型的表现会变得非常不可预测。

另外，重力和局部拉力的设定虽然在某种程度上模拟了实际的物理过程，但这些力的参数并没有经过严格的物理验证。这意味着，当这些力的参数稍有变动时，模型的行为可能会出现剧烈变化，从而导致系统无法稳定下来。

## 更精确的方程就是与物理对应良好的方程

而解决这个问题的策略是构造与物理对应得更好的方程。

- 首先，这些方程应该足够精确，能够真实地反映物理世界中的各种力学关系。例如，使用弹性力学中的胡克定律来描述节点之间的弹力，用牛顿运动定律来描述节点的运动状态。这些方程需要考虑到节点之间的相互作用力、外部施加的重力以及节点的惯性等。
- 其次，这些方程的参数应该充分反映整个物理过程，确保每个参数都有明确的物理意义。例如，弹性常数、重力加速度、摩擦系数等都应当被合理设定，并在模拟过程中保持稳定。这样，模型不仅能在各种力学参数变化时保持稳定，还能更准确地反映实际物理现象。

通过引入更加严谨的物理方程和参数设置，有望构建出一个更稳定、更准确的网带模型，能够在更广泛的条件下稳定收敛，并准确模拟出一条受重力和拉力作用的弹性带子。
