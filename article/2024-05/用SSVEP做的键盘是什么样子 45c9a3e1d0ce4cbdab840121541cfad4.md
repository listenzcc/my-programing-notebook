# 用SSVEP做的键盘是什么样子

Title: 用SSVEP做的键盘是什么样子
Date: 2024-5-6
Keywords: BCI, WebGL

---

随着计算机处理能力的不断提升以及设备的普及和智能化，脑电实验不应该再局限于实验室环境。通过网页等在线平台，可以简单而高效地进行脑电实验，比如下面这个玩具就将SSVEP实验的视觉诱发材料搬到了电脑和手机屏幕上。

---

## 把准时闪烁搬到网页上

SSVEP的核心是稳态序列的呈现与提取，呈现是在电脑端，而在脑电实验中，提取是在脑电信号的采集和处理端。由于玩具的成本不能过高，因此本文只介绍电脑端的显示模块。

如果用SSVEP做一个脑控键盘，那么只需要将实体按键映射在电脑屏幕上即可。这些实体按键对应闪烁的刺激块。如下图所示，左图是一个$7 \times 5$的刺激块阵列；右图代表每个块的参数分布。

![Untitled](%E7%94%A8SSVEP%E5%81%9A%E7%9A%84%E9%94%AE%E7%9B%98%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E5%AD%90%2045c9a3e1d0ce4cbdab840121541cfad4/Untitled.png)

本玩具提供了相当自由的设置选项，可以任意指定每个闪烁块的参数。右图是界面示意图，实际使用时它是动态闪烁的。

![Untitled](%E7%94%A8SSVEP%E5%81%9A%E7%9A%84%E9%94%AE%E7%9B%98%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E5%AD%90%2045c9a3e1d0ce4cbdab840121541cfad4/Untitled%201.png)

![Untitled](%E7%94%A8SSVEP%E5%81%9A%E7%9A%84%E9%94%AE%E7%9B%98%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E5%AD%90%2045c9a3e1d0ce4cbdab840121541cfad4/Untitled%202.png)

## WebGL实现准时

众所周知，WebGL进行实时渲染的速度非常快，因此我根据实验设计生成平面模型，之后让模型按照余弦规律闪烁即可，每个刺激块有两个参数，分别代表闪烁频率和相位

$$
f(t) = cos(\omega \cdot t + \varphi)
$$

其中，$t$代表时间（单位是秒）。

## Canvas实现标签

由于在WebGL上写字过于费劲，因此我采用将另一个Canvas叠加在WebGL上的方式实现标签，图中黄色字符代表两个参数；图中红色字符代表闪烁块的标签。

## 人性化的适配

为了更好地说明SSVEP的快速闪烁过程，我设置了一个重要的控件，用于调整显示框架的“时间流速”。便于更加清楚地看到闪烁过程。这里需要说明的是gif本身有抽帧的毛病，实际打开网页看上去不会这么卡顿，而是很流畅的闪烁。

![Untitled](%E7%94%A8SSVEP%E5%81%9A%E7%9A%84%E9%94%AE%E7%9B%98%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E5%AD%90%2045c9a3e1d0ce4cbdab840121541cfad4/Untitled.gif)

[SSVEP Layout](https://observablehq.com/@listenzcc/ssvep-layout)

## 附录：何为SSVEP

SSVEP是一种稳态视觉诱发电位，是大脑对于特定频率的视觉刺激作出的生理反应。在脑电实验中，通过观察被测者的脑电信号，可以推断其注意力集中在哪个刺激频率上，从而实现脑控制应用。
