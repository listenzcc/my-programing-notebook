# 随机游走中的预测错觉：回归模型的崩溃与解析

Title: 随机游走中的预测错觉：回归模型的崩溃与解析
Date: 2024-5-20
Keywords: Regression, Time-series

---

回归模型在处理随机游走这种非平稳时间序列时，容易产生预测的错觉。这种错觉在短期内可能表现为良好的预测效果，但随着时间的推移和$k$值的增加，模型的预测能力迅速崩溃。究其原因在于数据的非平稳性和损失函数的局限性。因此，在处理类似随机游走的时间序列时，应该谨慎使用传统的回归模型，并考虑更加适合的模型和评估方法。

[https://github.com/listenzcc/Timeseries-regression.git](https://github.com/listenzcc/Timeseries-regression.git)

---

[toc]

## 连续时间序列

使用一维随机游走的方式生成连续时间序列，每次更新的位置变化服从标准正态分布。因此，它的微分是不可预测的，但粗制滥造的回归模型可以观测到很好的回归效果。本文对其进行展示和解释。

随机游走的定义如下：

$$
x_{t+1} = x_{t} + \epsilon_t, \epsilon \sim N(0, 1)
$$

由于 $\epsilon_t$ 的随机性，可以认为$x_t$ 是一个不可预测的时间序列。

## 预测的错觉与崩溃

构建回归模型：

$$
y_{t+1} = f(x_{t-n}, x_{t-n+1}, \dots, x_{t})
$$

在这个模型中，我们试图通过过去的$n$个时间点的值来预测未来的值。当我们开始增加参数$k$时，模型表现出开始失效的现象：

$$
y_{t+1} = \sigma_k(x_{t-k-n}, x_{t-k-n+1}, \dots, x_{t-k})
$$

模型的预测能力明显下降，这种现象的原因可以通过以下几点解释：

## **错觉解析：它只是在用最后一个值**

回归模型试图用它观测到的最后一个值来预测下一个值，这个方法在$k=0$时是成立的，但随着$k$值的增加，回归开始失效。究其原因有二：

1. **从数据平稳性的角度来说**：随机游走本质上是一个非平稳序列。尽管在短期内，它的局部趋势可以被模型捕捉到，但随着时间的推移，随机游走的不可预测性导致了预测的失效。特别是当$k$增加时，模型所依据的数据点越来越远离当前时间点，数据的相关性减弱，使得模型难以捕捉有效的预测信号。
2. **从损失函数合理性的角度来说**：传统的回归模型通常使用均方误差（MSE）作为损失函数。然而，对于随机游走这样的非平稳序列，MSE在一定程度上掩盖了模型的失效。模型可能会在短期内表现出较低的误差，但在长期预测时，由于噪声和趋势的不确定性，误差会迅速增加。这种现象在$k$值增加时尤为明显，因为模型的预测值越来越依赖于过去的无关数据点。

以下图示展示了随着$k$值（Predict offset）增加，回归模型的预测效果逐渐崩溃的现象。图中展示了回归模型在不同$k$值下的预测表现。可以看出，当$k$较小时，模型能够较好地跟踪时间序列的变化，但随着$k$的增加，模型的预测能力显著下降，甚至变得毫无意义。

另外，在$k=0$时模型的预测误差与随机游走的步长呈现较强的相关性，这也说明了模型只是在做最朴素的复制最后一项的操作而已。对于连续函数来说，其MSE是接近零的，但这种预测毫无意义。

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%AD%E7%9A%84%E9%A2%84%E6%B5%8B%E9%94%99%E8%A7%89%EF%BC%9A%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B4%A9%E6%BA%83%E4%B8%8E%E8%A7%A3%E6%9E%90%2039bdc24ea48b4471a9ebba49c712ca1a/Untitled.png)

![Untitled](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%AD%E7%9A%84%E9%A2%84%E6%B5%8B%E9%94%99%E8%A7%89%EF%BC%9A%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B4%A9%E6%BA%83%E4%B8%8E%E8%A7%A3%E6%9E%90%2039bdc24ea48b4471a9ebba49c712ca1a/Untitled%201.png)
