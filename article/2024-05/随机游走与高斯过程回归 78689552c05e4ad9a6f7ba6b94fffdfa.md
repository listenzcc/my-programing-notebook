# 随机游走与高斯过程回归

Title: 随机游走与高斯过程回归
Date: 2024-5-24
Keywords: Gaussian-processes, Time-series

---

高斯过程是一种基于核函数的非参数贝叶斯方法，用于预测和回归。其预测依赖于训练数据的分布和相似性。在密集采样区域，模型能捕捉数据趋势，尽管误差较大，但预测值与真实值相关；在没有采样的区域，因缺乏数据，模型预测失效，退化为均值。这体现了高斯过程对局部数据的依赖性。

[https://github.com/listenzcc/Timeseries-regression.git](https://github.com/listenzcc/Timeseries-regression.git)

---

[toc]

## 高斯过程

高斯过程（Gaussian Processes, GP）是一种非参数化的贝叶斯方法，用于回归和分类问题。其基本原理是将数据视为从一个多元正态分布中采样得到的，因此，对于任意一个新的输入点，其对应的输出可以根据已知数据的分布来预测。

在高斯过程中，我们假设任意一组输入点的对应输出是联合高斯分布的。这意味着，对于一组已知的观测数据，我们可以推断出未知点的输出的分布，而不是仅仅一个点估计。这种方法的优势在于它不仅提供了预测的均值，还给出了预测的不确定性，这在很多应用中是非常有用的。

高斯过程的基本过程如下：

**训练数据**：假设我们有训练数据 $D = \{(x_i, y_i)\}_{i=1}^n$，其中  $x_i$  是输入，  $y_i$  是对应的输出。

**核函数**：我们定义一个核函数 $k(x, x')$ ，用来描述任意两个输入点之间的相似性。常见的核函数包括RBF核（径向基函数核）、Matern核等。

**协方差矩阵**：基于核函数，我们可以构建一个协方差矩阵$\Sigma$，其中 $\Sigma_{ij} = k(x_i, x_j)$。

**预测**：对于一个新的输入 $x^*$ ，其对应的输出$y^*$ 的预测分布也是一个高斯分布，均值和方差可以通过以下公式计算：

$$
\begin{cases}
\mu(x^*) &= k(x^*, X)^T \Sigma^{-1} y \\
\sigma^2(x^*) &= k(x^*, x^*) - k(x^*, X)^T \Sigma^{-1} k(x^*, X)
\end{cases}
$$

*其中，$X$是所有训练输入点的集合， $y$是对应的输出值向量， $k(x^*, X)$* 表示新的输入点与所有训练点的核函数值向量。高斯过程模型在处理时间序列预测时表现优异，尤其在不确定性估计和处理稀疏数据上具有明显优势。

## 实验：高斯过程预测随机游走

实验数据为随机生成的一维随机游走数据，每次更新位置的步长服从标准正态分布。图中蓝色点为观测点，这些点的位置和值都是已知的，作为模型参数的训练数据

$$
y=f(x), x \in D
$$

根据这些训练数据对其他值进行预测

$$
\hat{y}=\delta(x^*), x^*\notin D
$$

由于我在设置观测点时有一些思考，因此将数据区域分布密集采样和无采样两个区域，接下来将结果分开讨论。首先，对于”**密集采样**“的区域，即最后一个采样点左侧的区域，这时尽管预测误差较大，但预测值（红线）与真实值（蓝线）具有一定的相关性。这表明模型至少能够对邻近采样点之间的信号进行预测。

其次，对于”**没有采样**“的区域，即最后一个采样点右侧的区域，这时高斯过程完全失效，表现为无法对后续的任何值进行预测，只会将最保守的测值作为预测均值。这表明模型由于缺少右侧值，此时已经不能有效生成任何预测值。

![gaussian_process.jpg](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B%E5%9B%9E%E5%BD%92%2078689552c05e4ad9a6f7ba6b94fffdfa/gaussian_process.jpg)

接下来我在训练数据中加入观测到的最后一个时间点，并计算预测效果。结果表明，由于这个点距离前一个观测点过远，因此也无法为模型提供更多的有效信息。

![gaussian_process_fit_with_latest_point.jpg](%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B%E5%9B%9E%E5%BD%92%2078689552c05e4ad9a6f7ba6b94fffdfa/gaussian_process_fit_with_latest_point.jpg)

## 现象解释

**从数据依赖性的角度来说**,高斯过程是一个非参数方法，它通过训练数据的分布来进行预测。在训练数据稀疏或缺乏的区域，模型无法准确地了解数据的分布特性，因此预测的准确性大大降低。在密集采样区域，高斯过程可以利用邻近的观测点来捕捉数据的趋势，即使误差较大，预测值和真实值仍有一定相关性。而在没有采样的区域，模型只能依赖于训练数据的总体趋势或最后一个观测值，从而导致预测失效。

**考虑核函数特性**，高斯过程依赖于核函数来定义数据点之间的相似性和相关性。常用的核函数，如RBF（径向基函数）核，具有局部性特征，即它对相距较远的点赋予较低的相似性值。这意味着，只有在训练数据点附近，高斯过程模型才能做出可靠的预测。

$$
k(x, x')=exp(-\frac{(x-x')^2}{2\sigma^2})
$$

对于RBF核函数，随着$\vert x-x' \vert$增加，$k(x, x')$快速减小，这说明远离训练点的区域预测不可靠。

**从协方差矩阵的角度来说**，在高斯过程中，协方差矩阵的构建是基于训练数据的核函数值。当预测点与训练数据点相距较远时，核函数值趋近于零，使得预测点与训练数据点之间的协方差变小。这种情况下，预测值主要受均值函数影响，通常会退化为最后一个观测值的均值。

$$
\mu(x^*) = k(x^*, X)^T \Sigma^{-1} y
$$

因此有如下现象

1. **密集采样区域**：在密集采样区域，尽管预测误差较大，但由于邻近点的协方差较高，模型能够捕捉到数据的趋势，从而使预测值和真实值具有一定相关性。
2. **没有采样区域**：在没有采样的区域，模型缺乏足够的观测数据来推断数据分布，因此只能依赖于现有数据的整体趋势或最后一个观测值的均值，导致预测失效。

高斯过程模型在数据稀疏区域和密集区域的表现差异反映了其依赖核函数和训练数据分布的特性。密集采样区域提供了足够的局部信息，使模型能够捕捉数据趋势，而在没有采样的区域，由于缺乏足够的协方差信息，模型无法进行有效预测。这些现象在高斯过程理论中是合理且预期的。
