# 凸多边形的最大内切椭圆

Title: 凸多边形的最大内切椭圆
Date: 2024-8-20
Keywords: Machine learning, Convex, Optimization

---

给定任意凸多边形，求它的最大内切椭圆。这是一个开放问题，难以获得解析解。但机器学习算法可以比较容易地解决它。

[Max ellipse within given shape with gradient method](https://observablehq.com/@listenzcc/max-ellipse-within-given-shape)

---
[toc]

## 方法简述

我首先实现了多边形内部的最大内切椭圆的计算方法，它可以在已知椭圆两个焦点的条件下计算出可行的最大内切椭圆。由于该算法是可微的，因此可以从某个起点开始，利用梯度方法不断迭代，最终找到更大的椭圆直到收敛。

由于我不确定问题的解是否唯一，也不确定是否能够找到全局最优解，因此我绘制出了焦点的迭代轨迹。图中点的颜色越白，代表椭圆的面积越大；反之颜色越黑代表椭圆的面积越小。也就是说，这些迭代轨迹从黑到白的过程代表梯度方法逐步收敛的过程。

在这个过程中可以看到几种有趣的趋势，简述如下。

## 大概有唯一解的情况

有理由猜测，这种“长条形状”的多边形内部的最大椭圆是唯一的。

![image.png](%E5%87%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%86%85%E5%88%87%E6%A4%AD%E5%9C%86%202c31847bea944196a39fb3228f3d173b/image.png)

![image.png](%E5%87%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%86%85%E5%88%87%E6%A4%AD%E5%9C%86%202c31847bea944196a39fb3228f3d173b/image%201.png)

## 大概没有唯一解的情况

有理由猜测，这种“三角形状”的多边形内部的最大椭圆不是唯一的。

![image.png](%E5%87%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%86%85%E5%88%87%E6%A4%AD%E5%9C%86%202c31847bea944196a39fb3228f3d173b/image%202.png)

![image.png](%E5%87%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%86%85%E5%88%87%E6%A4%AD%E5%9C%86%202c31847bea944196a39fb3228f3d173b/image%203.png)

## 概率分布

如果从概率的观点来看，迭代轨迹的颜色同时代表了最大内接椭圆的焦点位置的概率分布。

![image.png](%E5%87%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%86%85%E5%88%87%E6%A4%AD%E5%9C%86%202c31847bea944196a39fb3228f3d173b/image%204.png)
